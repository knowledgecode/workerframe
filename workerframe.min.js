/*
 workerframe (c) 2015 KNOWLEDGECODE | MIT
*/
(function(d){var h=d.URL||d.webkitURL,l=function(){var a=d.BlobBuilder||d.WebKitBlobBuilder||d.MSBlobBuilder;return a?function(c,b){var k=new a;k.append(c[0]);return k.getBlob(b.type)}:d.Blob}(),g=function(a){var c,b=this;if(this===window||"function"!==typeof a)throw new TypeError("Failed to construct 'WorkerFrame'.");c=h.createObjectURL(new l(["(%s('%s', '%s', %s));".replace("%s",function(b,c,a){var f=self,d={},g=f.importScripts,h=Array.prototype.slice;f.importScripts=function(){h.call(arguments).map(function(e){var a=
c;if(!/^(https?|file):\/\//.test(e)){if(/^\.{1,2}\//.test(e)){for(;0===e.indexOf("../");)e=e.slice(3),a=a.replace(/\/[^\/]*\/?$/,"/");for(;0===e.indexOf("./");)e=e.slice(2)}else 0===e.indexOf("/")&&(a="");e=b+a+e}g(e)})};f.message=function(e,a,b){postMessage({_type:e,_data:a},b)};f.console={log:function(){f.message("_l",h.call(arguments))}};f.on=function(a,b){var c=d[a]||[];0>c.indexOf(b)&&(c.push(b),d[a]=c);return b};f.off=function(a,b){var c,k=d[a]||[];c=k.indexOf(b);0<=c&&k.splice(c,1)};f.addEventListener("message",
function(a){var b=a.data._type,c=a.data._data;b&&((d[b]||[]).map(function(b){b(c)}),"close"===b&&(f.close(),f.message("_c")))});a()}.toString()).replace("%s",location.origin.replace("null","file://")).replace("%s",location.pathname.replace(/\/[^\/]*$/,"/")).replace("%s",a.toString())],{type:"text/javascript"}));this._l={};this._w=new Worker(c);this._w.addEventListener("message",function(a){var d=a.data._type;a=a.data._data;switch(d){case "_l":console.log.apply(console,a);break;case "_c":h.revokeObjectURL(c);
b._l=b._w=void 0;break;default:b._d(d,a)}});this._w.addEventListener("error",function(a){b._d("error",a)})};g.prototype=new function(){this.message=function(a,c,b){this._w.postMessage({_type:a,_data:c},b)};this.close=function(){this.message("close")};this.on=function(a,c){var b=this._l[a]||[];0>b.indexOf(c)&&(b.push(c),this._l[a]=b);return c};this.off=function(a,c){var b,d=this._l[a]||[];b=d.indexOf(c);0<=b&&d.splice(b,1)};this._d=function(a,c){(this._l[a]||[]).map(function(a){a(c)})}};g.prototype.constructor=
g;"function"===typeof define&&define.amd?define([],function(){return g}):d.WorkerFrame=g})(this);
